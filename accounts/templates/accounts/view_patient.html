{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container py-5">

    <div class="card shadow p-4 mb-4 text-center">
        <img src="{% if patient.profile_pic %}{{ patient.profile_pic.url }}{% else %}{% static 'images/avatar.png' %}{% endif %}"
             width="120" height="120" class="rounded-circle mb-3" style="object-fit: cover;">
        <h3>{{ patient.username }}</h3>
        <p class="text-muted">{{ patient.email }}</p>
        <p class="small">Joined: {{ patient.date_joined|date:"F j, Y" }}</p>
    </div>

    <div class="d-flex gap-2 mb-3">
        <a href="{% url 'export_patient_csv' patient.id %}" class="btn btn-success">Export CSV</a>
        <a href="{% url 'export_patient_pdf' patient.id %}" class="btn btn-danger">Export PDF</a>
    </div>

    <h4>Recent Posts</h4>
    <ul class="list-group mb-3">
        {% for post in recent_posts %}
        <li class="list-group-item">{{ post.title }} - {{ post.created_at|date:"F j, Y H:i" }}</li>
        {% empty %}
        <li class="list-group-item text-muted">No posts yet.</li>
        {% endfor %}
    </ul>

    <h4>Recent Comments</h4>
    <ul class="list-group mb-3">
        {% for comment in recent_comments %}
        <li class="list-group-item">{{ comment.comment_text }} - <small>{{ comment.created_at|date:"F j, Y H:i" }}</small></li>
        {% empty %}
        <li class="list-group-item text-muted">No comments yet.</li>
        {% endfor %}
    </ul>

    <h4>Recent Prescriptions</h4>
    <ul class="list-group mb-3">
        {% for pres in recent_prescriptions %}
        <li class="list-group-item">{{ pres.diagnosis }} - <small>{{ pres.created_at|date:"F j, Y H:i" }}</small></li>
        {% empty %}
        <li class="list-group-item text-muted">No prescriptions yet.</li>
        {% endfor %}
    </ul>

    <a href="{% url 'doctor_dashboard' %}" class="btn btn-outline-primary mt-3">Back to Patient List</a>

</div>
{% endblock %}
